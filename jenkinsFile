pipeline {
    agent { label 'agent1' }

    stages {
        stage('employee and products management module') {
            steps {
                sh 'cd ./employee-and-products-management'
                sh(label: 'validating project', script: 'mvn clean validate')
                sh(label: 'compiling project', script: 'mvn compile')
                sh(label: 'prepare jacoco agent', script: 'mvn org.jacoco:jacoco-maven-plugin:0.8.12:prepare-agent')
                sh(label: 'testing project', script: 'mvn test')
                sh(label: 'generating jacoco coverage report', script: 'mvn org.jacoco:jacoco-maven-plugin:0.8.12:report')
                sh(label: 'analyzing with sonarQube', script: 'mvn org.sonarsource.scanner.maven:sonar-maven-plugin:3.11.0.3922:sonar')
            }
        }
    }
}
